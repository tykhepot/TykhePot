# TykhePot 合约规则文档

> 最后更新: 2026-02-23

## 📊 代币经济模型

### 初始分配 (总量 10亿 TPOT)
| 用途 | 比例 | 数量 | 说明 |
|------|------|------|------|
| 初始流动性 | 5% | 5000万 | DEX流动性 (合约外处理) |
| 空投池 | 10% | 1亿 | 每人100TPOT，领完即止 |
| 质押奖励池 | 35% | 3.5亿 | 质押用户奖励，耗完即止 |
| 前期奖池配额 | 20% | 2亿 | 1:1配捐，用完即止 |
| 团队代币 | 10% | 1亿 | 4年线性释放 |
| 推广奖励池 | 20% | 2亿 | 推荐奖励，耗完即止 |

### 用户存款流程
```
用户存款: 100% (扣除3%销毁)
├── 3% 记录为 pending_burn (待销毁)
└── 97% 进入奖池 + 前期配额

前期配额:
└── 1:1 配捐 (用户投100，配100，奖池+200)
```

### 开奖分配 (奖池 100%)
```
奖池分配:
├── 平台费 2% → 自动到账平台钱包
├── 销毁 3% → 转入 burn_vault
├── 奖金 93% → 分配给用户
│   ├── 头奖 30% (1人) = 27.9%
│   ├── 二奖 20% (2人) = 各 9.3%
│   ├── 三奖 15% (3人) = 各 4.65%
│   ├── 幸运奖 10% (5人) = 各 1.86%
│   └── 普惠奖 20% (全员) = 按人头均分
└── 回流 5% → 下期奖池
```

## 🎮 奖池规则

### 小时池
- 最低存款: 200 TPOT
- 开奖时间: 每小时
- 最低参与人数: 10人

### 天池
- 最低存款: 100 TPOT
- 开奖时间: 每天 UTC 0:00
- 最低参与人数: 10人

### 开奖规则
- **<10人参与**: 奖池余额返回储备池，不发放奖金
- **>=10人参与**: 正常开奖，按比例分配奖金
- 随机数种子: timestamp + 票号 (生产需Switchboard VRF)

## 👥 推荐系统

### 推荐奖励
- 推荐人获得: 8%
- 被推荐人获得: 2% (一次性)
- 从 referral_pool 池子发放

## 🎁 空投机制

### 领取规则
1. 每个钱包只能领取一次 (100 TPOT)
2. 领取后代币锁定在合约
3. 只能投入天池参与游戏
4. 不能直接转走

### 使用规则
- 使用 `deposit_daily_with_airdrop()` 投入天池
- 投入后参与正常开奖分配

## 🔒 团队代币

### 锁定规则
- 锁定时间: 4年 (从合约初始化开始)
- 释放方式: 线性释放 (48个月)
- 释放计算: `可释放 = 总团队代币 × (已过月数 / 48)`

## 📌 合约地址

- **Devnet**: `5Mmrkgwppa2kJ93LJNuN5nmaMW3UQAVs2doaRBsjtV5b`
- **Token**: `FQwBuM6DU76rXCLrJVciS8wQUPvkS58sbtQmrxG1WgdY`
- **Frontend**: `https://www.tykhepot.io`
- **GitHub**: `github.com/tykhepot/TykhePot`

## 🔐 Switchboard VRF 集成

### 工作原理
1. 创建 Switchboard VRF 账户
2. 调用 `set_vrf_result(result)` 设置随机数
3. 开奖时优先使用 VRF 结果
4. 如果 VRF 未设置，回退到时间戳

### 费用
- 测试网: 免费
- 主网: ~0.002-0.01 SOL/次

### 合约函数

| 函数 | 说明 |
|------|------|
| initialize() | 初始化合约和各个池子 |
| deposit_hourly() | 小时池存款 |
| deposit_daily() | 天池存款 |
| deposit_daily_with_airdrop() | 使用锁定空投存款 |
| draw_hourly() | 小时池开奖 |
| draw_daily() | 天池开奖 |
| claim_airdrop() | 领取空投 |
| claim_team_tokens() | 团队领取锁定代币 |
| get_pool_status() | 查询各池状态 |
| pause()/resume() | 暂停/恢复合约 |

## ⚠️ 待完成

- [ ] 主网上线前集成 Switchboard VRF
- [ ] 合约安全审计
- [ ] 前端 UI 完善
